<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>Hello WESA</title>
    <link rel="stylesheet" type="text/css" href="../css/demo-iframe.css">
</head>

<body>

    <div class="wrapper">
        <canvas id="canvas" width="320" height="240"></canvas>
    </div>
    <div class="dynamic-output" id="output">WESA Platformer Demo</div>

    <script src="../../src/wesa.js"></script>
    <script src="../../src/wesa.platform.js"></script>
    <script src="./jumper.js"></script>

    <script>

        const canvas = document.getElementById('canvas');

        // Initialize WESA
        wesa.core.init(canvas);

        // Adding assets ready for loading
        wesa.assets.source.spriteSheetUrlArray.push('./jumper.png');
        wesa.assets.source.spriteSheetUrlArray.push('./platform.png');
        wesa.assets.source.objectJsonUrl = './jumper.json';

        // Load assets
        wesa.assets.load(function () {

            // Create the scene
            var scene = new wesa.Scene('Scene');

            // Add test sprite
            let jumper = new wesa.Sprite({
                object: wesa.assets.storedObjects[0],
                action: 0,
                position: { x: 0, y: 0 },
                scale: 2
            });
            jumper.flags.platformCollisionCheck = true;
            jumper.acceleration.y = -0.25;
            scene.addSpriteToLayer(0, jumper);

            // Add test pillar
            let pillar = new Jumper.Pillar({
                scene: scene,
                x: 0,
                height: 1
            });

            // Run the scene
            var animate = function () {
                requestAnimationFrame(animate);
                scene.update();



                Jumper.util.ProcessPlatformCollisions(scene.getPlatformCollisions());


                scene.render();
            }
            animate();

        });

    </script>

</body>

</html>
